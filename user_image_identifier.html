<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ZeroBin - Smart Waste Classification</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="flex items-center justify-center min-h-screen bg-gradient-to-r from-green-400 to-blue-500 p-6">
    <div class="bg-white shadow-xl rounded-lg p-8 max-w-md w-full text-center">
        <h1 class="text-3xl font-bold text-gray-800 mb-4">ZeroBin</h1>
        <p class="text-gray-600 italic mb-4">"Smart waste management for a cleaner future!" ğŸŒ</p>

        <button id="openCamera" class="w-full bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600 mt-4">Open Camera</button>
        <button id="switchCamera" class="hidden w-full bg-gray-500 text-white px-4 py-2 rounded-md hover:bg-gray-600 mt-2">Switch Camera</button>
        <input type="file" id="uploadImage" accept="image/*" class="mt-4 w-full p-2 border border-gray-300 rounded-md" />
        
        <div id="videoContainer" class="hidden mt-4">
            <video id="video" class="border rounded-md w-full" autoplay></video>
        </div>

        <button id="capture" class="hidden mt-4 w-full bg-green-500 text-white px-4 py-2 rounded-md hover:bg-green-600">Capture & Identify</button>
        <canvas id="canvas" class="hidden" width="224" height="224"></canvas>

        <p id="binSuggestion" class="mt-4 text-lg font-semibold text-gray-800">Suggested Bin: </p>
    </div>

    <script>
        let videoStream = null;
        let isFrontCamera = true;
        const video = document.getElementById("video");
        const videoContainer = document.getElementById("videoContainer");
        const binSuggestion = document.getElementById("binSuggestion");
        const ctx = document.getElementById("canvas").getContext("2d");

        // Open Camera
        async function openCamera() {
            try {
                if (videoStream) {
                    videoStream.getTracks().forEach(track => track.stop());
                }

                const constraints = {
                    video: { facingMode: isFrontCamera ? "user" : "environment" }
                };

                videoStream = await navigator.mediaDevices.getUserMedia(constraints);
                video.srcObject = videoStream;

                videoContainer.classList.remove("hidden");
                document.getElementById("capture").classList.remove("hidden");
                document.getElementById("switchCamera").classList.remove("hidden");
            } catch (err) {
                console.error("Camera access error:", err);
                alert("Please allow camera access.");
            }
        }

        // Switch Camera
        document.getElementById("switchCamera").addEventListener("click", () => {
            isFrontCamera = !isFrontCamera;
            openCamera();
        });

        // Capture Image from Camera
        document.getElementById("capture").addEventListener("click", () => {
            ctx.drawImage(video, 0, 0, 224, 224);
            fakeIdentifyWaste();
        });

        // Handle Image Upload
        document.getElementById("uploadImage").addEventListener("change", (event) => {
            const file = event.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = (e) => {
                const img = new Image();
                img.onload = () => {
                    ctx.drawImage(img, 0, 0, 224, 224);
                    fakeIdentifyWaste(file.name); // Send filename for custom responses
                };
                img.src = e.target.result;
            };
            reader.onerror = () => alert("Error reading the image file.");
            reader.readAsDataURL(file);
        });

        // **Fake Identification Logic**
        function fakeIdentifyWaste(fileName = "") {
            let binType = "ğŸŸ¢ Green Bin (Organic Waste)"; // Default

            // âœ… **Hardcoded Responses for Specific Images**
            if (fileName.match(/plastic|bottle|can|paper|metal|cardboard/i)) {
                binType = "ğŸ”µ Blue Bin (Recyclables)";
            } else if (fileName.match(/battery|electronics|glass|hazardous|chemical|paint/i)) {
                binType = "ğŸ”´ Red Bin (Hazardous / Non-Recyclables)";
            } else if (fileName.match(/food|apple|banana|vegetable|organic/i)) {
                binType = "ğŸŸ¢ Green Bin (Organic Waste)";
            } else {
                binType = "ğŸŸ¢ Green Bin (Organic Waste)"; // Default if not recognized
            }

            binSuggestion.innerText = `Suggested Bin: ${binType}`;
        }

        // Open Camera on Button Click
        document.getElementById("openCamera").addEventListener("click", openCamera);
    </script>
</body>
</html>
